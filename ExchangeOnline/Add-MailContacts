Import-Module ExchangeOnlineManagement
Add-Type -AssemblyName System.Windows.Forms
$FileBrowser = New-Object System.Windows.Forms.OpenFileDialog -Property @{ 
    InitialDirectory = [Environment]::GetFolderPath('Desktop') 
    Title = 'Select magistrados.csv'
}
Connect-ExchangeOnline -Credential (Get-Credential) -Verbose
Write-Host "Select the CSV file with users to add to DL" -ForegroundColor Green -BackgroundColor Black
$null = $FileBrowser.ShowDialog()
$Magistrados = Import-Csv -Path $FileBrowser.filename
$FileBrowser = New-Object System.Windows.Forms.OpenFileDialog -Property @{ 
    InitialDirectory = [Environment]::GetFolderPath('Desktop') 
    Title = 'Select servidores.csv'
}
$null = $FileBrowser.ShowDialog()
$Servidores = Import-Csv -path $FileBrowser.filename
$DLMagistrados = "tjmt.magistrados@365.tjmt.jus.br"
$DLServidores = "tjmt.servidores@365.tjmt.jus.br"
foreach ($Magistrado in $Magistrados){
    New-MailContact -Name $Magistrado.Name -ExternalEmailAddress $Magistrado.Email
    Add-DistributionGroupMember -identity $DLMagistrados -Member $Magistrado.Email -Confirm:$false
}
foreach ($Servidor in $Servidores){
    New-MailContact -Name $Servidor.Name -ExternalEmailAddress $Servidor.Email
    Add-DistributionGroupMember -identity $DLServidores -Member $Servidor.Email -Confirm:$false
}